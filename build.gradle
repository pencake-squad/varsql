/*
 * This file was generated by the Gradle 'init' task.
 *
 * This generated file contains a sample Java Library project to get you started.
 * For more details take a look at the Java Libraries chapter in the Gradle
 * User Manual available at https://docs.gradle.org/6.0.1/userguide/java_library_plugin.html
 */
 
buildscript {
	repositories {
		mavenCentral()
		jcenter()
	}
}

configurations.all {
    resolutionStrategy.dependencySubstitution {
        substitute module("com.varsql.libs") with project(':libs')
    }
}

def def_build= [
	dir : 'target'
]
 
subprojects {
    apply plugin: 'java'
    apply plugin: 'eclipse'
    apply plugin: 'war'
    
    repositories {
        jcenter()
    	flatDir{dirs rootProject.file( 'libs' )}
    }
    
    def def_version = [
		spring: '5.2.1.RELEASE'
		,springData: '2.2.2.RELEASE'
		,springSecurity: '5.2.1.RELEASE'
		,servletApi: '3.1.0'
		,jackson : '2.9.9' 
		,poi : '3.17'
		,tiles : '3.0.7'
		,tomcat : '8.5.49' 
		,jspApi : '2.1' 
		,slf4j : '1.7.29'
		,tiles : '3.0.7'
		,junit : '5.4.2'
		,junitPlatform : '1.4.0'
	]
    
    sourceCompatibility = 1.8
    targetCompatibility = 1.8
    
    task initSourceFolders {
	    sourceSets*.java.srcDirs*.each {
	        if( !it.exists() ) {
	            it.mkdirs()
	        }
	    }
	    
	    sourceSets*.resources.srcDirs*.each {
	        if( !it.exists() ) {
	            it.mkdirs()
	        }
	    }
	}
	
	dependencies {
		//junit
		testImplementation(
			 'org.junit.jupiter:junit-jupiter:5.4.2'
		)
		testRuntimeOnly(
			[ group: 'org.junit.jupiter' , name: 'junit-jupiter-engine' , version: def_version.junit ]
			,[ group: 'org.junit.jupiter' , name: 'junit-jupiter-params' , version: def_version.junit ]
			
			,[ group: 'org.junit.platform' , name: 'junit-platform-launcher' , version: def_version.junitPlatform ]
			,[ group: 'org.junit.platform' , name: 'junit-platform-runner' , version: def_version.junitPlatform ]
		) 
		
		
		implementation fileTree (dir: rootProject.file( 'libs' ), include:['*.jar'])
		
		implementation( // spring
			[ group: 'org.springframework' , name: 'spring-beans' , version: def_version.spring ]
			,[ group: 'org.springframework' , name: 'spring-context' , version: def_version.spring ]
			,[ group: 'org.springframework' , name: 'spring-core' , version: def_version.spring ]
			,[ group: 'org.springframework' , name: 'spring-webmvc' , version: def_version.spring ]
			,[ group: 'org.springframework' , name: 'spring-jdbc' , version: def_version.spring ]
			,[ group: 'org.springframework' , name: 'spring-aspects' , version: def_version.spring ]
			,[ group: 'org.springframework' , name: 'spring-orm' , version: def_version.spring ]
			,[ group: 'org.springframework' , name: 'spring-oxm' , version: def_version.spring ]
		)
		
		implementation( // security
			[ group: 'org.springframework.security' , name: 'spring-security-acl' , version: def_version.springSecurity ]
			,[ group: 'org.springframework.security' , name: 'spring-security-config' , version: def_version.springSecurity ]
			,[ group: 'org.springframework.security' , name: 'spring-security-core' , version: def_version.springSecurity ]
			,[ group: 'org.springframework.security' , name: 'spring-security-taglibs' , version: def_version.springSecurity ]
			,[ group: 'org.springframework.security' , name: 'spring-security-web' , version: def_version.springSecurity ]
		)
		
		implementation( // apache.commons
			[ group: 'org.apache.commons' , name: 'commons-dbcp2' , version: '2.2.0']
			,[ group: 'org.apache.commons' , name: 'commons-collections4' , version: '4.4']
			,[ group: 'org.apache.commons' , name: 'commons-lang3' , version: '3.9']
			,[ group: 'org.apache.commons' , name: 'commons-csv' , version: '1.7']
			,[ group: 'org.apache.commons' , name: 'commons-compress' , version: '1.18']
		)
		
		implementation( // jackson
			[ group: 'com.fasterxml.jackson.core' , name: 'jackson-core' , version: def_version.jackson ]
			,[ group: 'com.fasterxml.jackson.core' , name: 'jackson-annotations' , version: def_version.jackson ]
			,[ group: 'com.fasterxml.jackson.core' , name: 'jackson-databind' , version: def_version.jackson ]
		)
		
		implementation( // poi
			[ group: 'org.apache.poi' , name: 'poi' , version: def_version.poi ]
			,[ group: 'org.apache.poi' , name: 'poi-ooxml' , version: def_version.poi ]
		)
		
		implementation( // tiles
			[ group: 'org.apache.tiles' , name: 'tiles-core' , version: def_version.tiles ]
			,[ group: 'org.apache.tiles' , name: 'tiles-jsp' , version: def_version.tiles ]
		)
		
		implementation( // log
			[ group: 'org.slf4j' , name: 'slf4j-api' , version: '1.7.26']
			,[ group: 'ch.qos.logback' , name: 'logback-classic' , version: '1.2.3']
			,[ group: 'org.codehaus.janino' , name: 'janino' , version: '3.0.12']
		)
		
		implementation group: 'org.springframework.data' , name: 'spring-data-jpa' , version: def_version.springData
		implementation group: 'org.hibernate' , name: 'hibernate-validator' , version: '6.0.17.Final'
		implementation group: 'org.hibernate' , name: 'hibernate-entitymanager' , version: '5.4.9.Final'
		
		implementation group: 'com.zaxxer', name: 'HikariCP', version: '3.4.1'
		implementation group: 'org.jdom' , name: 'jdom' , version: '1.1.3'
		implementation group: 'org.mybatis' , name: 'mybatis' , version: '3.4.2'
		implementation group: 'org.mybatis' , name: 'mybatis-spring' , version: '1.3.1'
		
		implementation group: 'commons-io' , name: 'commons-io' , version: '2.6'
		implementation group: 'commons-fileupload' , name: 'commons-fileupload' , version: '1.4'
		implementation group: 'commons-codec' , name: 'commons-codec' , version: '1.11'
		
		implementation group: 'com.alibaba' , name: 'druid' , version: '1.1.12'
		implementation group: 'com.thoughtworks.xstream' , name: 'xstream' , version: '1.4.11'
		implementation group: 'org.antlr' , name: 'stringtemplate' , version: '4.0.2'
		implementation group: 'com.github.jknack' , name: 'handlebars' , version: '4.1.0'
		implementation group: 'jstl' , name: 'jstl' , version: '1.2'
		
		providedCompile(
			[ group: 'javax.servlet' , name: 'javax.servlet-api' , version: '3.1.0' ]
			, [ group: 'javax.servlet.jsp', name: 'jsp-api', version: def_version.jspApi	 ]
		)
		
		// db driver
		implementation(
			[ group: 'com.h2database' , name: 'h2' , version: '1.4.199' ]
		) 
	}
	
	test {
	    useJUnitPlatform()
	}
	
	
	// JAVA file compile charset
	[compileJava, compileTestJava]*.options*.encoding = 'UTF-8'
}

project(':varsql-core') {
	war {
	    enabled = false
	}
}

project(':varsql-web') {
    dependencies {
        compile project(':varsql-core')
    }
}